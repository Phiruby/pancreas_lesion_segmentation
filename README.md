# Pancreas Lesion Segmentation

This repository is the official implementation of `Pancreas Lesion Segmentation from CT Scans Using
Deep Learning`

### Environment and Requirements

- RAM: 16 GB
- GPU: T4 x2 (At least 16 GB GPU RAM needed)
- CUDA 12.1
- Python 3.11.4

### Preprocessing

This can be viewed in the plans file generated by nnUNetv2. But here are a few:
- CTNormalization
- CT Windowing

### Training

To train the model, you need to place `scripts/conv_classifier_colab.py` inside of nnUNetv2's training directory. (In Google colab / Kaggle, if you install nnUNetv2 via pip, you will need to find the `site-packages` folder for nnUNetv2 and find the `training` folder inside of that)

Once that is done, run `!nnUNetv2_train Dataset001_M31Pancreas 3d_fullres 1 -device 'cuda' -num_gpus 2 -p nnUNetResEncUNetM -tr nnUNetMultiTaskTrainer`

### Inference

For inference, run
```
!nnUNetv2_predict -i INPUT_PATH -p nnUNetResEncUNetMPlans -chk checkpoint_best.pth -f 1 --verbose -c 3d_fullres -d 001 -o OUTPUT_PATH -device 'cuda' -tr nnUNetMultiTaskTrainer
```
